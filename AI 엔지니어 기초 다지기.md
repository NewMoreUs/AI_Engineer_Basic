# 정형 데이터

## 정형 데이터 정의
정형 데이터
- 액셀 파일 형식이나 관계형 데이터베이스의 테이블에 담을 수 있는 데이터로 행(row)과 열(column)으로 표현 가능한 데이터. 하나의 행은 데이터 인스턴스를 나타내고, 각 열은 데이터의 피처를 나타냄

비정형 데이터
- 이미지, 비디오, 음성, 자연어 등의 정제되지 않은 데이터
- 정형 데이터와 달리 틀이 없고, 테이블 형식으로 표시할 수 없음
- 하나의 데이터 인스턴스로 표현하기 위해 흑백의 경우 2차원, 컬러의 경우 3차원이 필요함

## 정형 데이터의 중요성
- 범용적인 데이터: 사람, 기업, 현상, 사회의 많은 부분들이 정형데이터로 기록됨
- 기업에서 기본적으로 사용되는 데이터, 분야를 막론하고 많은 데이터가 정형데이터로 존재

정형 데이터의 분석 능력이란?
- 데이터에 대한 상상력과 통찰력
- 다양한 경험을 통해 데이터에 국한 되지 않고 범용적으로 쓰일 수 있는 능력

# 평가지표 이해
분류 (Classification)
- 예측해야 할 대상의 개수가 정해져 있는 문제
- 예) 이미지에서 개, 고양이 분류, 신용 카드 거래가 사기 거래인지 정상 거래인지 분류 등

회귀 (Regression)
- 예측해야 할 대상이 연속적인 숫자인 문제
- 예) 일기 예보에서 내일의 기온 예측, 주어진 데이터에서 집값 예측

평가지표 (Evaluation Metric)
- 분류, 회귀 머신러닝 문제의 성능을 평가할 지표


분류 문제에 대한 평가 지표 - Confusion Matrix

| Confusion Matrix | 예측 |  |
| ---- | ---- | ---- |
|  | Negative | Positive |
| 실제 | TN (True Negative) | FP (False Positive) |
|  | FN (False Negative) | TP (True Positive) |
- TP: model-P, 정답-P
- TN: model-N, 정답-N
- FP: model-N, 정답-P
- FN: model-P, 정답-N

Accuracy
1. Accuracy: (TP + TN) / (TP + TN + FP + FN)
2. precision: TP / (TP + FP)
3. Recall: TP / (TP + FN)

ROC (Receiver operating characteristic)
- 수신자 조작 특성
- True Positive Ratio: $TP/TP+FN$
- False Positive Ratio: $FP/FP+TN$

AUC (Area Under Curve)
- ROC 곡선의 면적을 표시한 것으로 0과 1 사이의 값을 가짐
- 1에 가까울수록 모델이 잘 예측하는 것을 뜻함

# EDA (Exploratory Data Analysis, 탐색적 데이터 분석) 
## EDA 정의
- 데이터의 특징과 구조적 관계를 알아내기 위해 시각화나 통계적 방법을 통해 다양한 각도에서 관찰하고 이해하는 과정
- 요약하면, 데이터를 탐색하고 가설을 세워 증명하는 과정
- 다양한 시각을 통해 데이터를 이해하고 특징을 찾아내는 과정
	- 이러한 특징들을 시각화, 통계량으로 표현
	- 데이터를 특징과 문제들을 직관적으로 이해
- 정형, 비정형 모든 데이터는 분석에 앞서서 이러한 EDA 과정을 수반함

## EDA 과정
데이터를 탐색하고 가설을 세우고 증명하는 과정
주어진 문제를 데이터를 통해 해결하기 위해 데이터를 이해하는 과정
- 문제를 해결하는 과정에서 데이터에 대한 이해는 필수적임
- 문제에 대한 이해와 데이터에 대한 이해를 통해 적절한 전처리, 방법론들을 선택
즉 데이터를 통한 문제를 해결하기 위해 데이터를 이해하고 적절한 방법들을 적용

# 데이터 전처리 (Data Preprocessing)
- 머신러닝 모델에 데이터를 입력하기 위해 데이터를 처리하는 과정
- 데이터 전처리는 다음과 같은 방식들에 따라 달리 수행됨
	- EDA (Exploratory Data Analysis)
	- 모델의 입력 데이터를 어떻게 넣을지
	- 선형 모델, 트리, 딥러닝 모델들 중 어떤걸 사용할지
- 연속형, 범주형 처리
- 결측치 처리
- 이상치 처리

## 연속형 처리
*Scaling*
- 데이터 단위 혹은 분포를 변경하는 작업
- 선형 기반의 모델 (선형회귀, 딥러닝 등)인 경우 변수들 간의 스케일을 맞추는 것이 필수적임
*Scaling 방법*
- Min Max scaling
$$X_{new} = X_i - min(X) / max(x) -min(X) $$
- Standard Scaling
$$X_new = x - \mu / \delta$$
- Robust Scaling
$$X_{scale} = x_i - m_{med} / x_{75} - x_{25}$$

- Saling and Distribution
- Binning

## 범주형 처리
*Encoding*
1. One hot encoding
2. Label encoding
3. Frequency encoding
4. Target encoding
5. Embedding

One hot encoding
- 변수를 1과 0으로 나누는 인코딩 기법
- 해당 값이 존재하면 1, 존재하지 않으면 0으로 설정
- Ex) 개, 고양이 존재 유무 테이블

| ID | 품종 |
| ---- | ---- |
| 1 | 개 |
| 2 | 고양이 |
| 3 | 개 |
| 4 | 개 |
| 5 | 개, 고양이 |

| ID | 종_개 | 종_고양이 |
| ---- | ---- | ---- |
| 1 | 1 | 0 |
| 2 | 0 | 1 |
| 3 | 1 | 0 |
| 4 | 1 | 0 |
| 5 | 1 | 1 |
Label encoding
- 각각의 값을 숫자로 부여하는 인코딩 기법
- 선형 모델의 경우, 각 숫자를 순서로 인식할 수 있기에 유의해야 함

| ID | 품종 |
| ---- | ---- |
| 1 | 1 |
| 2 | 2 |
| 3 | 1 |
| 4 | 1 |
| 5 | 3 |
Frequency encoding
- 해당 변수의 값이 몇 번 나오는 지에 대한 빈도수를 변수의 값으로 사용하는 인코딩 기법
- 각각의 값을 수치로 바꿈으로써 하나의 컬럼에 모든 값을 표현할 수 있는 장점과 순서에 영향을 받지 않는 장점이 있음
- 동일한 값으로 인코딩 된 값을 가지는 문제가 있음
- 새로 들어온 종에 대해서 인코딩 할 수 없음
- 의미 있는 값을 모델에 줄 수 있음

Target encoding
- 각각의 종이 가지는 타겟 변수의 평균으로 인코딩하는 기법
- 각각의 값을 수치로 바꿈으로써 하나의 컬럼에 모든 값을 표현할 수 있는 장점과 순서에 영향을 받지 않는 장점이 있음
- 의미 있는 값을 모델에 줄 수 있음
- 동일한 값으로 인코딩 된 값을 가지는 문제가 있음
- 새로 들어온 종에 대해서 인코딩 할 수 없음
- Overfitting이 발생할 수 있기에 대처 방안이 필요

Embedding (Entity Embedding)
- Text 데이터에 대해서 수치화하기 힘들 경우에 사용함
- Word2Vec 모델을 사용하여 낮은 차원으로 임베딩을 처리한다 사용 가능